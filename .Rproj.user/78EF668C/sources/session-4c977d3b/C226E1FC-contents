# 1. JPM
## train
### Load Data
getSymbols("JPM", from = train_start_date, to = train_end_date)
train_jpm_prices <- Cl(get("JPM"))
train_jpm_daily_returns <- dailyReturn(train_jpm_prices)
colnames(train_jpm_daily_returns) <- "return"
train_jpm_yearly_returns <- period.apply(train_jpm_daily_returns, endpoints(train_jpm_daily_returns, on = "years"), 
                                          function(x) prod(1 + x) - 1)

### Print Statistic Data
print(summary(train_jpm_daily_returns))
print(train_jpm_yearly_returns)
print(summary(train_jpm_yearly_returns))

### Plot Data
autoplot(train_jpm_prices, colour="blue") + 
  labs(title = "JPM Price 2009 - 2018", x="Date", y="Price") + theme_minimal() +
  theme(plot.title = element_text(hjust=0.5))

autoplot(train_jpm_daily_returns, colour="blue") + 
  labs(title = "JPM Daily Returns 2009 - 2018", x="Date", y="Return") + theme_minimal() +
  theme(plot.title = element_text(hjust=0.5))

autoplot(train_jpm_yearly_returns, colour="blue") + 
  labs(title = "JPM Yearly Returns 2009 - 2018", x="Date", y="Return") + theme_minimal() +
  theme(plot.title = element_text(hjust=0.5))

### Additional Analysis
#### Sharpe Ratio
train_jpm_daily_sharpe_ratio <- SharpeRatio(train_jpm_daily_returns, Rf = daily_risk_free_rate, FUN = "StdDev")
train_jpm_yearly_sharpe_ratio <- SharpeRatio(train_jpm_yearly_returns, Rf = yearly_risk_free_rate, FUN = "StdDev")

#### Treynor Ratio
train_jpm_daily_treynor_ratio <- TreynorRatio(train_jpm_daily_returns, Rf = daily_risk_free_rate, Rb = train_market_daily_returns)
train_jpm_yearly_treynor_ratio <- TreynorRatio(train_jpm_yearly_returns, Rf = yearly_risk_free_rate, Rb = train_market_yearly_returns)

#### Information Ratio
train_jpm_daily_information_ratio <- InformationRatio(train_jpm_daily_returns, train_market_daily_returns)
train_jpm_yearly_information_ratio <- InformationRatio(train_jpm_yearly_returns, train_market_yearly_returns)

### Print the Additional Analysis results
print("JPM Daily Data 2009 - 2018")
cat("Sharpe Ratio:", train_jpm_daily_sharpe_ratio, "\n")
cat("Treynor Ratio:", train_jpm_daily_treynor_ratio, "\n")
cat("Information Ratio:", train_jpm_daily_information_ratio, "\n")

print("JPM Yearly Data 2009 - 2018")
cat("Sharpe Ratio:", train_jpm_yearly_sharpe_ratio, "\n")
cat("Treynor Ratio:", train_jpm_yearly_treynor_ratio, "\n")
cat("Information Ratio:", train_jpm_yearly_information_ratio, "\n")


## test
### Load Data
getSymbols("JPM", from = test_start_date, to = test_end_date)
test_jpm_prices <- Cl(get("JPM"))
test_jpm_daily_returns <- dailyReturn(test_jpm_prices)
colnames(test_jpm_daily_returns) <- "return"
test_jpm_yearly_returns <- period.apply(test_jpm_daily_returns, endpoints(test_jpm_daily_returns, on = "years"), 
                                         function(x) prod(1 + x) - 1)

### Print Statistic Data
print(summary(test_jpm_daily_returns))
print(test_jpm_yearly_returns)

### Plot Data
autoplot(test_jpm_prices, colour="blue") + 
  labs(title = "JPM Price 2019", x="Date", y="Price") + theme_minimal() +
  theme(plot.title = element_text(hjust=0.5))

autoplot(test_jpm_daily_returns, colour="blue") + 
  labs(title = "JPM Daily Returns 2019", x="Date", y="Return") + theme_minimal() +
  theme(plot.title = element_text(hjust=0.5))


### Additional Analysis
#### Sharpe Ratio
test_jpm_daily_sharpe_ratio <- SharpeRatio(test_jpm_daily_returns, Rf = daily_risk_free_rate, FUN = "StdDev")
test_jpm_yearly_sharpe_ratio <- SharpeRatio(test_jpm_yearly_returns, Rf = yearly_risk_free_rate, FUN = "StdDev")

#### Treynor Ratio
test_jpm_daily_treynor_ratio <- TreynorRatio(test_jpm_daily_returns, Rf = daily_risk_free_rate, Rb = test_market_daily_returns)
test_jpm_yearly_treynor_ratio <- TreynorRatio(test_jpm_yearly_returns, Rf = yearly_risk_free_rate, Rb = test_market_yearly_returns)

#### Information Ratio
test_jpm_daily_information_ratio <- InformationRatio(test_jpm_daily_returns, test_market_daily_returns)
test_jpm_yearly_information_ratio <- InformationRatio(test_jpm_yearly_returns, test_market_yearly_returns)

### Print the Additional Analysis results
print("JPM Daily Data 2019")
cat("Sharpe Ratio:", test_jpm_daily_sharpe_ratio, "\n")
cat("Treynor Ratio:", test_jpm_daily_treynor_ratio, "\n")
cat("Information Ratio:", test_jpm_daily_information_ratio, "\n")

print("JPM Yearly Data 2019")
cat("Sharpe Ratio:", test_jpm_yearly_sharpe_ratio, "\n")
cat("Treynor Ratio:", test_jpm_yearly_treynor_ratio, "\n")
cat("Information Ratio:", test_jpm_yearly_information_ratio, "\n")